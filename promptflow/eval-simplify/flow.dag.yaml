$schema: https://azuremlschemas.azureedge.net/promptflow/latest/Flow.schema.json
environment:
  python_requirements_txt: requirements.txt
inputs:
  original_text:
    type: string
    default: Original text
  simplified_text:
    type: string
    default: Simplified text
  model:
    type: string
    default: gpt-4o
  prompt:
    type: string
    default: The prompt used to generate the simplified text
outputs:
  zix_score_original:
    type: string
    reference: ${score_original.output}
  zix_score_simplified:
    type: string
    reference: ${score_simplified.output}
  level_original:
    type: string
    reference: ${level_original.output}
  level_simplified:
    type: string
    reference: ${level_simplified.output}
  estimated_cost:
    type: string
    reference: ${estimate_cost.output.cost}
  value_for_money:
    type: string
    reference: ${estimate_cost.output.value}
nodes:
- name: aggregate_scores
  type: python
  source:
    type: code
    path: aggregate.py
  inputs:
    scores_original: ${score_original.output}
    scores_simplified: ${score_simplified.output}
    estimated_cost: ${estimate_cost.output.cost}
    value_for_money: ${estimate_cost.output.value}
  aggregation: true
- name: score_simplified
  type: python
  source:
    type: code
    path: calculate_score.py
  inputs:
    text: ${inputs.simplified_text}
- name: level_original
  type: python
  source:
    type: code
    path: cefr_level.py
  inputs:
    score: ${score_original.output}
  aggregation: false
- name: score_original
  type: python
  source:
    type: code
    path: calculate_score.py
  inputs:
    text: ${inputs.original_text}
- name: level_simplified
  type: python
  source:
    type: code
    path: cefr_level.py
  inputs:
    score: ${score_simplified.output}
- name: estimate_cost
  type: python
  source:
    type: code
    path: estimate_cost.py
  inputs:
    original: ${inputs.original_text}
    simplified: ${inputs.simplified_text}
    model: ${inputs.model}
    prompt_used: ${inputs.prompt}
    score_original: ${score_original.output}
    score_simplified: ${score_simplified.output}
